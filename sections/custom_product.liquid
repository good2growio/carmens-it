{% assign pageurl = content_for_header| split:'"pageurl":"' | last | split:'"' | first %}

{% assign last_tag = pageurl | split : '\/' | last %}

{% if last_tag contains '?' %}
{% assign last_tag = last_tag | split : '?' | first %}  
{%endif%}
{% assign blankurl = '' %}
{% for block in section.blocks %}
{% if block.type == 'block-1' and block.settings.featured_product !=blank and last_tag == block.settings.featured_product  %}
{% capture blankurl%} {{blankurl}},{{block.settings.featured_product}} {%endcapture%}
{%endif%}

{%endfor%}


<div class="{% if section.settings.narrow_column !=  blank %} page-width {% endif %}" >
  {%- style -%}
  @media screen and (max-width: 768px) {
  .background-media-text--{{ block.id }} {
  background-image: url({{ block.settings.image | img_url: '1x1' }});
  }
  }
  {%- endstyle -%}
  {% for block in section.blocks %}
  {% if block.type == 'block-1' and block.settings.featured_product !=blank and last_tag == block.settings.featured_product %}
  <div class="block1">
    
    {%- if block.settings.title != blank -%}
    <p class="bg-image-heading h3 bg-image-mobile">{{ block.settings.title | escape }}</p>
    {%- endif -%}
    <div class="background-image-main" style="position:relative;">
      <div
           data-section-id="{{ block.id }}"
           data-section-type="background-image"
           class="background-media-text background-media-text--{{ block.id }} background-media-text--{{ block.settings.height }} loaded"
           data-aos="background-media-text__animation"
           {% if block.settings.parallax %}data-parallax="true"{% endif %}>

        <div class="background-media-text__container">
          {%- if block.settings.parallax -%}
          <div class="parallax-container">
            <div class="parallax-image">
              {%- endif -%}

              {%- if block.settings.image != blank -%}
              {%- assign img_url = block.settings.image | img_url: '1x1' | replace: '_1x1.', '_{width}x.' -%}
              <img
                   class="image-fit background-media-text__image background-media-text__image--{{ block.id }} lazyload"
                   src=""
                   data-src="{{ img_url }}"
                   data-aspectratio="{{ block.settings.image.aspect_ratio }}"
                   data-widths="[720, 900, 1080, 1800, 2400]"
                   data-sizes="auto"
                   alt="{{ block.settings.image.alt | escape }}"
                   style="object-position: {{ section.settings.focal_point }}">
              <noscript>
                <img
                     class="image-fit background-media-text__image background-media-text__image--{{ block.id }} lazyloaded"
                     src="{{ block.settings.image | img_url: '1800x' }}"
                     alt="{{ block.settings.image.alt }}">
              </noscript>
              {%- else -%}
              {{ 'lifestyle-1' | placeholder_svg_tag: 'placeholder-svg' }}
              {%- endif -%}

              {%- if block.settings.parallax -%}
            </div>
          </div>
          {%- endif -%}
        </div>
        {%- if block.settings.subtitle != blank or block.settings.title != blank or block.settings.text != blank -%}
        <div class="background-media-text__inner">
          <div class="background-media-text__aligner background-media-text--{{ block.settings.layout }}">
            <div class="animation-cropper">
              <div class="animation-contents">
                <div class="background-media-text__text{% if block.settings.framed %} background-media-text__text--framed{% endif %}">
                  {%- if block.settings.subtitle -%}
                  <p class="h5">{{ block.settings.subtitle }}</p>
                  {%- endif -%}
                  {%- if block.settings.title != blank -%}
                  <p class="h3 desktop">{{ block.settings.title | escape }}</p>
                  {%- endif -%}
                  {%- if block.settings.text != blank -%}
                  <div class="rte background-media-text__subtext desktop">{{ block.settings.text }}</div>
                  {%- endif -%}
                  {%- if block.settings.button_label != blank and block.settings.button_link != blank -%}
                  <a href="{{ block.settings.button_link }}" class="btn">
                    {{ block.settings.button_label }}
                  </a>
                  {%- endif -%}
                </div>
              </div>
            </div>
          </div>
        </div>
        {%- endif -%}
      </div>

      <div class="background-media-text__spacer background-media-text--{{ block.settings.height }}"></div>
    </div>

    {%- if block.settings.text != blank -%}
    <div class="bg-image-rte rte background-media-text__subtext bg-image-mobile">{{ block.settings.text }}</div>
    {%- endif -%}


  </div>
  {% else %}


  {% if block.type == 'block-2' %}
  <div class="block-2" {%if blankurl != blank %} style="display:none;" {%endif%}>


    {%- if block.settings.title != blank -%}
    <p class="bg-image-heading h3 bg-image-mobile">{{ block.settings.title | escape }}</p>
    {%- endif -%}
    <div class="background-image-main" style="position:relative;">
      <div
           data-section-id="{{ block.id }}"
           data-section-type="background-image"
           class="background-media-text background-media-text--{{ block.id }} background-media-text--{{ block.settings.height }} loaded"
           data-aos="background-media-text__animation"
           {% if block.settings.parallax %}data-parallax="true"{% endif %}>

        <div class="background-media-text__container">
          {%- if block.settings.parallax -%}
          <div class="parallax-container">
            <div class="parallax-image">
              {%- endif -%}

              {%- if block.settings.image != blank -%}
              {%- assign img_url = block.settings.image | img_url: '1x1' | replace: '_1x1.', '_{width}x.' -%}
              <img
                   class="image-fit background-media-text__image background-media-text__image--{{ block.id }} lazyload"
                   src=""
                   data-src="{{ img_url }}"
                   data-aspectratio="{{ block.settings.image.aspect_ratio }}"
                   data-widths="[720, 900, 1080, 1800, 2400]"
                   data-sizes="auto"
                   alt="{{ block.settings.image.alt | escape }}"
                   style="object-position: {{ block.settings.focal_point }}">
              <noscript>
                <img
                     class="image-fit background-media-text__image background-media-text__image--{{ block.id }} lazyloaded"
                     src="{{ block.settings.image | img_url: '1800x' }}"
                     alt="{{ block.settings.image.alt }}">
              </noscript>
              {%- else -%}
              {{ 'lifestyle-1' | placeholder_svg_tag: 'placeholder-svg' }}
              {%- endif -%}

              {%- if block.settings.parallax -%}
            </div>
          </div>
          {%- endif -%}
        </div>
        {%- if block.settings.subtitle != blank or block.settings.title != blank or block.settings.text != blank -%}
        <div class="background-media-text__inner">
          <div class="background-media-text__aligner background-media-text--{{ block.settings.layout }}">
            <div class="animation-cropper">
              <div class="animation-contents">
                <div class="background-media-text__text{% if block.settings.framed %} background-media-text__text--framed{% endif %}">
                  {%- if block.settings.subtitle -%}
                  <p class="h5">{{ block.settings.subtitle }}</p>
                  {%- endif -%}
                  {%- if block.settings.title != blank -%}
                  <p class="h3 desktop">{{ block.settings.title | escape }}</p>
                  {%- endif -%}
                  {%- if block.settings.text != blank -%}
                  <div class="rte background-media-text__subtext desktop">{{ block.settings.text }}</div>
                  {%- endif -%}
                  {%- if block.settings.button_label != blank and block.settings.button_link != blank -%}
                  <a href="{{ block.settings.button_link }}" class="btn">
                    {{ block.settings.button_label }}
                  </a>
                  {%- endif -%}
                </div>
              </div>
            </div>
          </div>
        </div>
        {%- endif -%}
      </div>

      <div class="background-media-text__spacer background-media-text--{{ block.settings.height }}"></div>
    </div>

    {%- if block.settings.text != blank -%}
    <div class="bg-image-rte rte background-media-text__subtext bg-image-mobile">{{ block.settings.text }}</div>
    {%- endif -%}


  </div>

  {% endif %}
  {% endif %}
  {% endfor %}

</div>


{% schema %}
{
"name": "Custom Product",
"class": "index-section--flush",
"settings": [
{
"type": "checkbox",
"id": "narrow_column",
"label": "Narrow column",
"default": true
}
],
"blocks":[
{
"type": "block-1",
"name": "Custom Product",
"settings": [
{
"type": "product",
"id": "featured_product",
"label": "Product"
},

{
"type": "checkbox",
"id": "space_around",
"label": "Add spacing above and below",
"default": true
},
{
"type": "text",
"id": "subtitle",
"label": "Subheading",
"default": "Impressive"
},
{
"type": "text",
"id": "title",
"label": "Heading",
"default": "Large image with text box"
},
{
"type": "richtext",
"id": "text",
"label": "Text",
"default": "<p>Pair large text with a full-width image to draw attention to an important detail of your brand or product line.</p>"
},
{
"type": "text",
"id": "button_label",
"label": "Button label"
},
{
"type": "url",
"id": "button_link",
"label": "Button link"
},
{
"type": "image_picker",
"id": "image",
"label": "Image"
},
{
"type": "select",
"id": "focal_point",
"label": "Image focal point",
"info": "Used to keep the subject of your photo in view.",
"default": "center",
"options": [
{
"value": "20% 0",
"label": "Top left"
},
{
"value": "top",
"label": "Top"
},
{
"value": "80% 0",
"label": "Top right"
},
{
"value": "20% 50%",
"label": "Left"
},
{
"value": "center",
"label": "Middle"
},
{
"value": "80% 50%",
"label": "Right"
},
{
"value": "20% 100%",
"label": "Bottom left"
},
{
"value": "bottom",
"label": "Bottom"
},
{
"value": "80% 100%",
"label": "Bottom right"
}
]
},
{
"type": "select",
"id": "layout",
"label": "Layout",
"default": "left",
"options": [
{
"value": "left",
"label": "Text on left"
},
{
"value": "right",
"label": "Text on right"
}
]
},
{
"type": "range",
"id": "height",
"label": "Section height",
"default": 550,
"min": 450,
"max": 750,
"step": 100,
"unit": "px"
},
{
"type": "checkbox",
"id": "framed",
"label": "Add frame",
"default": false
},
{
"type": "checkbox",
"id": "parallax",
"label": "Enable parallax",
"default": true
}
]
},
{
"type": "block-2",
"name": "Generic Product",
"settings": [

{
"type": "checkbox",
"id": "narrow_column",
"label": "Narrow column",
"default": true
},
{
"type": "checkbox",
"id": "space_around",
"label": "Add spacing above and below",
"default": true
},
{
"type": "text",
"id": "subtitle",
"label": "Subheading",
"default": "Impressive"
},
{
"type": "text",
"id": "title",
"label": "Heading",
"default": "Large image with text box"
},
{
"type": "richtext",
"id": "text",
"label": "Text",
"default": "<p>Pair large text with a full-width image to draw attention to an important detail of your brand or product line.</p>"
},
{
"type": "text",
"id": "button_label",
"label": "Button label"
},
{
"type": "url",
"id": "button_link",
"label": "Button link"
},
{
"type": "image_picker",
"id": "image",
"label": "Image"
},
{
"type": "select",
"id": "focal_point",
"label": "Image focal point",
"info": "Used to keep the subject of your photo in view.",
"default": "center",
"options": [
{
"value": "20% 0",
"label": "Top left"
},
{
"value": "top",
"label": "Top"
},
{
"value": "80% 0",
"label": "Top right"
},
{
"value": "20% 50%",
"label": "Left"
},
{
"value": "center",
"label": "Middle"
},
{
"value": "80% 50%",
"label": "Right"
},
{
"value": "20% 100%",
"label": "Bottom left"
},
{
"value": "bottom",
"label": "Bottom"
},
{
"value": "80% 100%",
"label": "Bottom right"
}
]
},
{
"type": "select",
"id": "layout",
"label": "Layout",
"default": "left",
"options": [
{
"value": "left",
"label": "Text on left"
},
{
"value": "right",
"label": "Text on right"
}
]
},
{
"type": "range",
"id": "height",
"label": "Section height",
"default": 550,
"min": 450,
"max": 750,
"step": 100,
"unit": "px"
},
{
"type": "checkbox",
"id": "framed",
"label": "Add frame",
"default": false
},
{
"type": "checkbox",
"id": "parallax",
"label": "Enable parallax",
"default": true
}
]
}
],
"presets": [
{
"name": "Custom Product"
}

]
}
{% endschema %}




